graph TD
    %% Single-node design: 1 Leader (L1) on GPU0 and 29 Workers (W1-W29) across GPUs 0-3
    subgraph Node[Node-A100]
    GPU0[GPU 0]
    GPU1[GPU 1]
    GPU2[GPU 2]
    GPU3[GPU 3]

    %% Leader on GPU0
    GPU0 --> L1[Leader L1]

    %% Distribute 29 workers: 7 on GPU0, 7 on GPU1, 7 on GPU2, 8 on GPU3
    %% GPU0 workers (plus Leader)
    GPU0 --> W1[Worker W1]
    GPU0 --> W2[Worker W2]
    GPU0 --> W3[Worker W3]
    GPU0 --> W4[Worker W4]
    GPU0 --> W5[Worker W5]
    GPU0 --> W6[Worker W6]
    GPU0 --> W7[Worker W7]

    %% GPU1 workers
    GPU1 --> W8[Worker W8]
    GPU1 --> W9[Worker W9]
    GPU1 --> W10[Worker W10]
    GPU1 --> W11[Worker W11]
    GPU1 --> W12[Worker W12]
    GPU1 --> W13[Worker W13]
    GPU1 --> W14[Worker W14]

    %% GPU2 workers
    GPU2 --> W15[Worker W15]
    GPU2 --> W16[Worker W16]
    GPU2 --> W17[Worker W17]
    GPU2 --> W18[Worker W18]
    GPU2 --> W19[Worker W19]
    GPU2 --> W20[Worker W20]
    GPU2 --> W21[Worker W21]

    %% GPU3 workers (one extra to total 29)
    GPU3 --> W22[Worker W22]
    GPU3 --> W23[Worker W23]
    GPU3 --> W24[Worker W24]
    GPU3 --> W25[Worker W25]
    GPU3 --> W26[Worker W26]
    GPU3 --> W27[Worker W27]
    GPU3 --> W28[Worker W28]
    GPU3 --> W29[Worker W29]
    end
